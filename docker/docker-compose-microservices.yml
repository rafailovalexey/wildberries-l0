version: "3.8"

services:
  orders:
    container_name: "orders"
    hostname: "orders"
    restart: "always"
    ports:
      - "3000:3000"
    networks:
      - "network"
    env_file:
      - "../microservices/orders/.env"
    build:
      context: "../microservices/orders"
      dockerfile: "application.dockerfile"

  orders-subscriber:
    container_name: "orders_publisher"
    hostname: "orders_publisher"
    restart: "always"
    networks:
      - "network"
    env_file:
      - "../microservices/orders_subscriber/.env"
    build:
      context: "../microservices/orders_subscriber"
      dockerfile: "subscriber.dockerfile"

  orders-publisher:
    container_name: "orders_publisher"
    hostname: "orders_publisher"
    restart: "always"
    networks:
      - "network"
    env_file:
      - "../microservices/orders_publisher/.env"
    build:
      context: "../microservices/orders_publisher"
      dockerfile: "publisher.dockerfile"

networks:
  network:
    driver: "bridge"
